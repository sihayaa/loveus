<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Love Story Scrapbook</title>
  <script src="https://cdn.jsdelivr.net/npm/page-flip/dist/js/page-flip.browser.min.js"></script>
  <style>
    body {
      margin: 0;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      background: #0d0f2d; /* midnight blue */
      font-family: 'Patrick Hand', cursive;
      color: #fff;
    }

    #scrapbook {
      width: 90%;
      height: 90%;
    }

    .page {
      width: 100%;
      height: 100%;
      background: url("https://www.transparenttextures.com/patterns/cardboard-flat.png"); /* scrapbook texture */
      background-size: cover;
      padding: 20px;
      box-sizing: border-box;
      border: 4px dashed #67e4ca;
      position: relative;
    }

    .page h2 {
      margin: 0;
      font-size: 22px;
      color: #ffe9ec;
    }

    .floating-btns {
      position: fixed;
      bottom: 20px;
      right: 20px;
      display: none;
      flex-direction: column;
      gap: 10px;
      z-index: 1000;
    }

    .floating-btns button {
      padding: 10px 15px;
      border: none;
      border-radius: 8px;
      background: #67e4ca;
      color: #0d0f2d;
      cursor: pointer;
      font-weight: bold;
    }

    /* Themed modal */
    .modal {
      display: none;
      position: fixed;
      z-index: 2000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.7);
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .modal-content {
      background: #1a1f2e;
      padding: 20px;
      border-radius: 12px;
      border: 3px solid #67e4ca;
      color: #fff;
      min-width: 300px;
    }

    .modal-content textarea,
    .modal-content input {
      width: 100%;
      margin-top: 10px;
      padding: 8px;
      border-radius: 6px;
      border: none;
      outline: none;
    }

    .modal-content button {
      margin-top: 10px;
      padding: 8px 12px;
      border: none;
      border-radius: 6px;
      background: #67e4ca;
      color: #0d0f2d;
      font-weight: bold;
      cursor: pointer;
    }

    img.scrap-img {
      max-width: 200px;
      margin: 10px;
      border: 3px solid #ffe9ec;
      border-radius: 6px;
    }

    .text-block {
      background: rgba(255,255,255,0.1);
      padding: 8px;
      margin: 10px;
      border-radius: 6px;
      display: inline-block;
    }
  </style>
</head>
<body>
  <div id="scrapbook"></div>

  <!-- Floating buttons -->
  <div class="floating-btns" id="editorTools">
    <button onclick="openModal('text')">‚ûï Add Text</button>
    <button onclick="openModal('image')">üñºÔ∏è Add Image</button>
  </div>

  <!-- Modal -->
  <div id="modal" class="modal">
    <div class="modal-content">
      <h3 id="modalTitle">Add Content</h3>
      <div id="modalBody"></div>
      <button onclick="closeModal()">Cancel</button>
    </div>
  </div>

  <script>
    const pageFlip = new St.PageFlip(document.getElementById("scrapbook"), {
      width: 500,
      height: 700,
      size: "stretch",
      minWidth: 315,
      minHeight: 420,
      maxWidth: 1000,
      maxHeight: 1350,
      drawShadow: true,
      flippingTime: 700
    });

    pageFlip.loadFromHTML([
      { element: createPage("Cover Page") },
      { element: createPage("Our Journey") },
      { element: createPage("Memories Together") },
      { element: createPage("Forever") }
    ]);

    function createPage(title) {
      const div = document.createElement("div");
      div.className = "page";
      div.innerHTML = `<h2>${title}</h2>`;
      return div;
    }

    // Helper: get active page
    function getActivePage() {
      return document.querySelector(".stf__item--current .page");
    }

    // Modal control
    let currentMode = null;
    function openModal(type) {
      currentMode = type;
      const modal = document.getElementById("modal");
      const body = document.getElementById("modalBody");
      const title = document.getElementById("modalTitle");
      body.innerHTML = "";

      if (type === "text") {
        title.innerText = "Add Text";
        body.innerHTML = `<textarea id="newText" rows="3" placeholder="Type here..."></textarea>
                          <button onclick="addText()">Add</button>`;
      } else {
        title.innerText = "Add Image";
        body.innerHTML = `<input type="file" id="imageInput" accept="image/*" onchange="handleImageUpload(event)">`;
      }

      modal.style.display = "flex";
    }

    function closeModal() {
      document.getElementById("modal").style.display = "none";
    }

    // Add text
    function addText() {
      const text = document.getElementById("newText").value;
      if (text.trim() !== "") {
        const el = document.createElement("div");
        el.className = "text-block";
        el.innerText = text;
        getActivePage().appendChild(el);
      }
      closeModal();
    }

    // Handle image upload
    function handleImageUpload(event) {
      const file = event.target.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = function(e) {
          const img = document.createElement("img");
          img.src = e.target.result;
          img.className = "scrap-img";
          getActivePage().appendChild(img);
        }
        reader.readAsDataURL(file);
      }
      closeModal();
    }

    // Unlock editor with code
    document.addEventListener("keydown", (e) => {
      if (e.key === "1" || e.key === "2" || e.key === "3") {
        const code = prompt("Enter code to edit:");
        if (code === "123") {
          document.getElementById("editorTools").style.display = "flex";
          alert("Editor unlocked!");
        }
      }
    });
  </script>
</body>
</html>
