<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Our Scrapbook ‚Äî portrait, 14 pages (with covers)</title>
  <link href="https://fonts.googleapis.com/css2?family=Lobster&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#0b0f2f;          /* deep night blue */
      --paper:#f7eddc;       /* warm paper */
      --ink:#0d2a6b;         /* navy ink */
      --accent:#67e4ca;      /* mint */
      --accent2:#7a5af8;     /* purple */
      --shadow:0 18px 40px rgba(0,0,0,.35);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; background:var(--bg); color:var(--ink);
      display:flex; align-items:center; justify-content:center;
      font-family:"Lobster", cursive; letter-spacing:.3px;
      user-select:none; /* editing mode will re-enable where needed */
    }

    /* Stage (portrait) */
    #stage{ width:840px; height:1180px; position:relative; }

    /* Secret code tap (left edge) */
    #codeTap{
      position:absolute; left:-6px; top:42%; width:12px; height:96px; z-index:60; cursor:pointer;
      background:rgba(255,255,255,.08); border-radius:8px; border:1px solid rgba(255,255,255,.15);
    }
    #codeTap:active{ transform:scale(.98); }

    /* Toolbar (inside stage so it never goes off-screen) */
    #toolbar{
      position:absolute; left:50%; transform:translateX(-50%);
      top:10px; height:56px; display:flex; gap:10px; align-items:center; z-index:50;
      transition:opacity .2s ease, filter .2s ease, transform .2s ease;
    }
    #toolbar.hidden{ opacity:0; pointer-events:none; filter:blur(1px); transform:translateX(-50%) scale(.96); }
    .btn{
      padding:10px 14px; border-radius:14px; background:white; color:var(--ink);
      border:2px solid #e8e6e0; box-shadow:var(--shadow); cursor:pointer;
      font-size:16px; line-height:1; letter-spacing:.2px;
    }
    .btn[aria-pressed="true"]{ outline:3px solid var(--accent); }

    /* Page deck */
    #deck{ position:absolute; inset:80px 0 56px 0; display:flex; align-items:center; justify-content:center; }

    .page{
      position:absolute; width:720px; height:100%; background:var(--paper);
      border-radius:22px; box-shadow:var(--shadow); border:2px solid #efe6d5; display:none;
    }
    .page.active{ display:block; }

    /* layered look */
    .page::before, .page::after{
      content:""; position:absolute; inset:10px 12px; border-radius:18px; pointer-events:none;
      border:1px dashed rgba(13,42,107,.12); transform:rotate(.4deg);
    }
    .page::after{ inset:16px 18px; transform:rotate(-.6deg); }

    /* Covers styling */
    .page.cover{
      background:linear-gradient(145deg,#fde7e7,#fffdf8 45%,#e6f8f3);
      border-color:#fff; box-shadow:0 24px 60px rgba(0,0,0,.45);
    }
    .page.cover::before,.page.cover::after{ display:none; }

    .page-canvas{
      position:absolute; inset:34px; background:transparent; border-radius:14px; overflow:hidden;
      outline:2px dashed transparent; transition:outline-color .2s ease;
    }
    .page[data-active="true"] .page-canvas{ outline-color:rgba(122,90,248,.25); }

    /* Items */
    .item{ position:absolute; cursor:move; touch-action:none; }
    .note{
      min-width:140px; min-height:40px; padding:10px 12px; background:#fffef8; color:var(--ink);
      border:2px solid #e7dfcf; border-radius:12px; box-shadow:0 10px 25px rgba(0,0,0,.12);
      font-size:28px; line-height:1.15; user-select:text; outline:none; resize:both; overflow:auto;
    }
    .photo{ display:block; width:300px; height:auto; border-radius:14px; border:3px solid #fff; box-shadow:0 16px 30px rgba(0,0,0,.18); }

    .selected{ outline:3px solid var(--accent2); outline-offset:2px; }

    /* Nav arrows (kept inside stage) */
    .nav{
      position:absolute; top:50%; transform:translateY(-50%);
      width:54px; height:54px; border-radius:50%; background:white; box-shadow:var(--shadow);
      display:flex; align-items:center; justify-content:center; cursor:pointer; border:2px solid #e8e6e0; z-index:40;
      transition:transform .12s ease;
    }
    .nav:active{ transform:translateY(-50%) scale(.96); }
    #prev{ left:10px }
    #next{ right:10px }
    .nav svg{ width:26px; height:26px; fill:var(--ink) }

    /* Footer status */
    #status{ position:absolute; bottom:8px; left:0; right:0; display:flex; justify-content:center; gap:12px; font-size:14px; color:#e9f8f4; opacity:.9; text-align:center; }

    /* Click-to-nav zones (disabled in edit mode) */
    .hotzone{ position:absolute; top:80px; bottom:56px; width:28%; z-index:20; }
    .hz-left{ left:0; }
    .hz-right{ right:0; }

    @media (max-width:980px){
      #stage{ transform:scale(.8); transform-origin:center; }
    }
    @media (max-width:860px){
      #stage{ transform:scale(.72); }
    }
  </style>
</head>
<body>

  <div id="stage">
    <!-- secret unlock strip on the left edge -->
    <div id="codeTap" title=""></div>

    <!-- Toolbar (starts hidden; unlock with code 123) -->
    <div id="toolbar" class="hidden">
      <button id="toggleEdit" class="btn" aria-pressed="false">‚úèÔ∏è Edit</button>
      <button id="addText" class="btn">Ôºã Text</button>
      <label class="btn" style="display:inline-flex; align-items:center; gap:8px;">
        Ôºã Image <input id="addImg" type="file" accept="image/*" style="display:none">
      </label>
      <button id="clearPage" class="btn" title="Remove all items on this page">üßπ Clear Page</button>
      <button id="rehide" class="btn" title="Hide toolbar again">üîí Hide</button>
    </div>

    <!-- Nav arrows -->
    <div id="prev" class="nav" title="Previous page">
      <svg viewBox="0 0 24 24"><path d="M15.41 7.41 14 6l-6 6 6 6 1.41-1.41L10.83 12z"/></svg>
    </div>
    <div id="next" class="nav" title="Next page">
      <svg viewBox="0 0 24 24"><path d="M8.59 16.59 10 18l6-6-6-6-1.41 1.41L12.17 12z"/></svg>
    </div>

    <!-- Page deck: 14 portrait pages (1=front cover, 14=back cover) -->
    <div id="deck">
      <div class="page cover active" data-page="1" data-active="true">
        <div class="page-canvas" aria-label="Front Cover"></div>
      </div>
      <!-- Inner pages 2..13 (12 pages) -->
      <div class="page" data-page="2"><div class="page-canvas" aria-label="Page 2"></div></div>
      <div class="page" data-page="3"><div class="page-canvas" aria-label="Page 3"></div></div>
      <div class="page" data-page="4"><div class="page-canvas" aria-label="Page 4"></div></div>
      <div class="page" data-page="5"><div class="page-canvas" aria-label="Page 5"></div></div>
      <div class="page" data-page="6"><div class="page-canvas" aria-label="Page 6"></div></div>
      <div class="page" data-page="7"><div class="page-canvas" aria-label="Page 7"></div></div>
      <div class="page" data-page="8"><div class="page-canvas" aria-label="Page 8"></div></div>
      <div class="page" data-page="9"><div class="page-canvas" aria-label="Page 9"></div></div>
      <div class="page" data-page="10"><div class="page-canvas" aria-label="Page 10"></div></div>
      <div class="page" data-page="11"><div class="page-canvas" aria-label="Page 11"></div></div>
      <div class="page" data-page="12"><div class="page-canvas" aria-label="Page 12"></div></div>
      <div class="page" data-page="13"><div class="page-canvas" aria-label="Page 13"></div></div>
      <div class="page cover" data-page="14">
        <div class="page-canvas" aria-label="Back Cover"></div>
      </div>

      <!-- click-to-nav zones (disabled in edit) -->
      <div class="hotzone hz-left" title="Previous"></div>
      <div class="hotzone hz-right" title="Next"></div>
    </div>

    <div id="status"> <span id="pageLabel">Front Cover (1 / 14)</span> ‚Ä¢ <span>Autosaved</span> ‚Ä¢ <span>Tips: drag to move ‚Ä¢ [ / ] to resize ‚Ä¢ Delete to remove ‚Ä¢ Double‚Äëclick text to edit</span> </div>
  </div>

<script>
(function(){
  const deck = document.getElementById('deck');
  const pages = [...deck.querySelectorAll('.page')];
  const prevBtn = document.getElementById('prev');
  const nextBtn = document.getElementById('next');
  const toggleEdit = document.getElementById('toggleEdit');
  const addTextBtn = document.getElementById('addText');
  const addImgInput = document.getElementById('addImg');
  const clearPageBtn = document.getElementById('clearPage');
  const pageLabel = document.getElementById('pageLabel');
  const leftHz = document.querySelector('.hz-left');
  const rightHz = document.querySelector('.hz-right');
  const toolbar = document.getElementById('toolbar');
  const rehide = document.getElementById('rehide');
  const codeTap = document.getElementById('codeTap');

  const SECRET_CODE = '123';
  const SECRET_KEY = 'scrapbook_toolbar_unlocked';

  let current = 0; // index 0..13
  let edit = false;
  let zCounter = 10;
  const KEY = 'scrapbook_portrait_v2_14p';

  function getCanvas(i){ return pages[i].querySelector('.page-canvas'); }
  function nameFor(i){
    if(i===0) return 'Front Cover';
    if(i===pages.length-1) return 'Back Cover';
    return `Page ${i+1}`;
  }
  function showPage(i){
    if(i<0||i>=pages.length) return;
    pages.forEach((p,idx)=>{
      p.classList.toggle('active', idx===i);
      p.dataset.active = (idx===i);
    });
    current = i;
    pageLabel.textContent = `${nameFor(i)} (${i+1} / ${pages.length})`;
    save();
  }

  function enableEdit(on){
    edit = !!on;
    toggleEdit.setAttribute('aria-pressed', edit);
    document.body.style.userSelect = edit? 'text' : 'none';
    leftHz.style.pointerEvents = rightHz.style.pointerEvents = edit? 'none':'auto';
  }

  function unlockToolbar(){
    toolbar.classList.remove('hidden');
    localStorage.setItem(SECRET_KEY, '1');
  }
  function lockToolbar(){
    toolbar.classList.add('hidden');
    localStorage.removeItem(SECRET_KEY);
  }

  // secret: click strip ‚Üí prompt for code; also allow quick type 1-2-3 anywhere
  codeTap.addEventListener('click', ()=>{
    const code = prompt('Enter code');
    if(code===SECRET_CODE) unlockToolbar();
  });
  let seq=''; let timer=null;
  window.addEventListener('keydown', (e)=>{
    if(['1','2','3'].includes(e.key)){
      seq += e.key;
      clearTimeout(timer);
      timer = setTimeout(()=> seq='', 1200);
      if(seq===SECRET_CODE){ unlockToolbar(); seq=''; }
    } else { seq=''; }
  });

  rehide.addEventListener('click', lockToolbar);

  function createNote(){
    const el = document.createElement('div');
    el.className = 'item note';
    el.contentEditable = true;
    el.textContent = 'type here‚Ä¶';
    placeNew(el);
  }
  function createPhotoFromFile(file){
    const reader = new FileReader();
    reader.onload = e => {
      const img = document.createElement('img');
      img.className = 'item photo';
      img.src = e.target.result; // local preview
      placeNew(img);
    };
    reader.readAsDataURL(file);
  }
  function placeNew(el){
    const canvas = getCanvas(current);
    el.style.left = Math.round(canvas.clientWidth*0.12 + Math.random()*40) + 'px';
    el.style.top  = Math.round(canvas.clientHeight*0.14 + Math.random()*40) + 'px';
    el.style.zIndex = ++zCounter;
    canvas.appendChild(el);
    wireItem(el);
    save();
  }

  // Drag + select + simple resize via [ ] keys
  let drag = null; // {el,dx,dy}
  function wireItem(el){
    el.addEventListener('pointerdown', (e)=>{
      if(!edit) return; 
      select(el);
      drag = { el, dx:e.clientX - el.offsetLeft, dy:e.clientY - el.offsetTop };
      el.setPointerCapture(e.pointerId);
    });
    el.addEventListener('pointermove', (e)=>{
      if(!drag||drag.el!==el) return;
      const p = el.parentElement.getBoundingClientRect();
      let x = e.clientX - drag.dx; let y = e.clientY - drag.dy;
      x = Math.max(0, Math.min(x, p.width - el.offsetWidth));
      y = Math.max(0, Math.min(y, p.height - el.offsetHeight));
      el.style.left = x + 'px'; el.style.top = y + 'px';
    });
    el.addEventListener('pointerup', ()=>{ if(drag&&drag.el===el){ drag=null; save(); } });
    el.addEventListener('dblclick', ()=>{ if(edit && el.classList.contains('note')) el.focus(); });
    el.addEventListener('click', ()=>{ if(edit) select(el); });
  }

  let selected = null;
  function select(el){
    if(selected) selected.classList.remove('selected');
    selected = el; if(selected){ selected.classList.add('selected'); selected.style.zIndex = ++zCounter; }
  }
  window.addEventListener('keydown', (e)=>{
    if(!edit || !selected) return;
    if(e.key === 'Delete' || e.key === 'Backspace'){
      selected.remove(); selected=null; save(); e.preventDefault(); return;
    }
    if(e.key === '['){ // scale down
      if(selected.classList.contains('photo')){
        const w = selected.offsetWidth; selected.style.width = Math.max(80, w-20) + 'px'; save();
      }else if(selected.classList.contains('note')){
        selected.style.transform = `scale(${Math.max(.6, (parseFloat(selected.dataset.scale)||1)-.1)})`;
        selected.dataset.scale = parseFloat(selected.dataset.scale||'1')-.1; save();
      }
    }
    if(e.key === ']'){
      if(selected.classList.contains('photo')){
        const w = selected.offsetWidth; selected.style.width = (w+20) + 'px'; save();
      }else if(selected.classList.contains('note')){
        selected.style.transform = `scale(${Math.min(2, (parseFloat(selected.dataset.scale)||1)+.1)})`;
        selected.dataset.scale = (parseFloat(selected.dataset.scale||'1')+.1); save();
      }
    }
    if(e.key.toLowerCase()==='f'){ // bring to front quick
      selected.style.zIndex = ++zCounter; save();
    }
  });

  // Clear page
  clearPageBtn.addEventListener('click', ()=>{
    const canvas = getCanvas(current);
    if(confirm('Clear all items on this page?')){
      canvas.innerHTML=''; save();
    }
  });

  // Toolbar actions
  toggleEdit.addEventListener('click', ()=> enableEdit(!edit));
  addTextBtn.addEventListener('click', ()=>{ if(edit) createNote(); });
  addImgInput.addEventListener('change', (e)=>{
    if(!edit || !e.target.files?.length) return;
    createPhotoFromFile(e.target.files[0]); e.target.value='';
  });

  // Nav
  function next(){ if(current<pages.length-1){ showPage(current+1);} }
  function prev(){ if(current>0){ showPage(current-1);} }
  nextBtn.addEventListener('click', next);
  prevBtn.addEventListener('click', prev);
  rightHz.addEventListener('click', ()=>{ if(!edit) next(); });
  leftHz.addEventListener('click', ()=>{ if(!edit) prev(); });
  window.addEventListener('keydown', (e)=>{
    if(e.key==='ArrowRight' && !edit) next();
    if(e.key==='ArrowLeft' && !edit) prev();
  });

  // Save / Load from localStorage
  function save(){
    const data = { current, z:zCounter, pages:[] };
    pages.forEach((p,idx)=>{
      const pc = p.querySelector('.page-canvas');
      data.pages[idx] = pc.innerHTML;
    });
    localStorage.setItem(KEY, JSON.stringify(data));
  }
  function load(){
    const raw = localStorage.getItem(KEY);
    if(!raw) return;
    try{
      const data = JSON.parse(raw);
      if(typeof data.current==='number') current = Math.min(data.current, pages.length-1);
      if(typeof data.z==='number') zCounter = data.z;
      if(Array.isArray(data.pages)){
        data.pages.forEach((html,idx)=>{
          if(idx>=pages.length) return; // ignore extras if any
          const pc = getCanvas(idx);
          if(pc){ pc.innerHTML = html||''; [...pc.children].forEach(wireItem); }
        });
      }
    }catch(err){ console.warn('load fail', err); }
  }

  // Initialize
  if(localStorage.getItem(SECRET_KEY)==='1') toolbar.classList.remove('hidden');
  load();
  showPage(current);
  enableEdit(false);
})();
</script>
</body>
</html>
