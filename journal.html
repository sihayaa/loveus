<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Journal</title>

<!-- ===== FONT (CDN, works even if Google Fonts is blocked) ===== -->
<style>
@font-face{
  font-family:"Patrick Hand";
  font-style:normal;
  font-weight:400;
  font-display:swap;
  src:url("https://cdn.jsdelivr.net/fontsource/fonts/patrick-hand@latest/latin-400-normal.woff2") format("woff2");
}
</style>

<link rel="icon" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAucB9b0m1qYAAAAASUVORK5CYII=">

<style>
:root{
  --pageW:760px;
  --pageH:1060px;
  --bg:#0b0f2f;
  --paper:#f7eddc;
  --ink:#0d2a6b;
  --accent:#7a5af8;
  --mint:#67e4ca;

  /* ✅ DEFAULT FONT */
  --font:"Patrick Hand", cursive;

  --cover-img:url("https://raw.githubusercontent.com/sihayaa/loveus/refs/heads/main/journal-front.png");
  --cover-y:50%;
  --wall-bg:url("https://raw.githubusercontent.com/sihayaa/loveus/refs/heads/main/beautiful-dark-forest-wallpaper-960x600_1.jpg");
}

*{box-sizing:border-box}
html,body{
  height:100%;
  margin:0;
  overflow:hidden;
  background:var(--bg);
  color:var(--ink);
  font-family:var(--font);
}

/* ===== BACKGROUND ===== */
#wall{
  position:fixed;
  inset:0;
  background-image:var(--wall-bg);
  background-size:cover;
  background-position:center;
  pointer-events:none;
}

/* ===== STAGE ===== */
#stage{
  position:fixed;
  left:50%;
  top:50%;
  width:var(--pageW);
  height:var(--pageH);
  transform:translate(-50%,-50%);
}

#deck{position:absolute; inset:0; perspective:1200px}

/* ===== PAGE ===== */
.page{
  position:absolute;
  inset:0;
  background:var(--paper);
  border-radius:20px;
  border:2px solid #efe6d5;
  box-shadow:inset 0 0 60px rgba(0,0,0,.22), 0 18px 40px rgba(0,0,0,.35);
  opacity:.92;
  pointer-events:none;
}

.page.active{
  opacity:1;
  pointer-events:auto;
  z-index:3;
}

.page .page-canvas{
  width:100%;
  height:100%;
  padding:28px;
  position:relative;
}

.page.cover .page-canvas{
  padding:0;
  background:#0c102c;
  background-image:var(--cover-img);
  background-size:cover;
  background-position:50% var(--cover-y);
}

/* ===== SCRAP ITEMS ===== */
.scrap-item{
  position:absolute;
  z-index:1;
}

.scrap-text{
  font-family:var(--font);
  background:transparent;
  border:none;
  white-space:pre-wrap;
  min-height:1.2em;
}

.scrap-text[contenteditable="true"]{
  outline:2px dashed #7a5af888;
}

/* ===== NAV ===== */
.nav{
  position:absolute;
  top:50%;
  transform:translateY(-50%);
  width:56px;
  height:56px;
  border-radius:50%;
  border:none;
  background:#ffffffd8;
  cursor:pointer;
  font-size:22px;
  font-weight:900;
}

.nav.left{left:-72px}
.nav.right{right:-72px}

/* ===== ADD PAGE ===== */
.addpage{
  position:absolute;
  top:-56px;
  left:50%;
  transform:translateX(-50%);
  padding:10px 14px;
  border-radius:12px;
  border:none;
  background:#ffffffd8;
  font-weight:900;
  display:none;
}

body.editing .addpage{display:block}

/* ===== TOOLBAR ===== */
#toolbar{
  position:fixed;
  right:16px;
  top:50%;
  transform:translateY(-50%);
  width:260px;
  background:#fff;
  border-radius:14px;
  padding:12px;
  display:none;
  flex-direction:column;
  gap:10px;
}

#toolbar.open{display:flex}

#toolbar button{
  border:none;
  padding:8px;
  border-radius:8px;
  font-weight:700;
  cursor:pointer;
}

#toolbar .mint{background:var(--mint)}
#toolbar .secondary{background:#5d47d4;color:#fff}
#toolbar .warn{background:#ff9aa2}

/* ===== TEXT EDITOR ===== */
#textEditor{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.6);
  display:none;
  align-items:center;
  justify-content:center;
}

#textEditor.open{display:flex}

#textEditor textarea{
  width:100%;
  height:320px;
  font:28px/1.4 var(--font);
}
</style>
</head>

<body>
<div id="wall"></div>

<div id="stage">
  <div id="deck">
    <div class="page cover active"><div class="page-canvas"></div></div>
    <div class="page"><div class="page-canvas"></div></div>
    <div class="page"><div class="page-canvas"></div></div>
    <div class="page"><div class="page-canvas"></div></div>
  </div>

  <button class="nav left" id="prev">◀</button>
  <button class="nav right" id="next">▶</button>
  <button class="addpage" id="addPageBtn">＋ Add Page</button>
</div>

<!-- ===== TOOLBAR ===== -->
<div id="toolbar">
  <button id="addTextBtn" class="mint">Add Text</button>
  <button id="exitEdit" class="warn">Exit Edit</button>
</div>

<!-- ===== TEXT EDITOR ===== -->
<div id="textEditor">
  <textarea id="editorInput" placeholder="type here…"></textarea>
</div>

<script>
/* ===== FONT MAP ===== */
const FONT_MAP = {
  patrick: '"Patrick Hand", cursive'
};

function familyFromValue(){ return FONT_MAP.patrick }

/* ===== BASIC EDIT MODE ===== */
const PASSCODE = "123";
let buffer = "";

document.addEventListener("keydown", e=>{
  if(!/^[1-3]$/.test(e.key)) return;
  buffer += e.key;
  if(buffer.endsWith(PASSCODE)){
    document.body.classList.add("editing");
    document.getElementById("toolbar").classList.add("open");
    buffer="";
  }
  setTimeout(()=>buffer="",1000);
});

/* ===== ADD TEXT ===== */
document.getElementById("addTextBtn").onclick = ()=>{
  const page = document.querySelector(".page.active .page-canvas");
  const box = document.createElement("div");
  box.className = "scrap-item";
  box.style.left = "40px";
  box.style.top = "40px";
  box.innerHTML = `<div class="scrap-text" contenteditable="true">write here…</div>`;
  page.appendChild(box);
};

/* ===== EXIT EDIT ===== */
document.getElementById("exitEdit").onclick = ()=>{
  document.body.classList.remove("editing");
  document.getElementById("toolbar").classList.remove("open");
};
</script>
</body>
</html>
